<div class="ui-g import" style="display: block;">
  <div class="ui-g-12 ui-g-nopad" style="background-color:white;">
    <div class="ui-g-10">
      <!-- <app-calendar [startYear]="2016" [isPreMonth]="true" (dateClickHandle)="dateClickHandle($event)"></app-calendar> -->
      <label>日期:</label>
      <p-dropdown [options]="yearList" [(ngModel)]="selectedYear"></p-dropdown>
      <!-- <label style="font-size: 18px;">现地:</label>
      <p-dropdown [options]="siteName" [(ngModel)]="selectedSite"></p-dropdown> -->
    </div>
    <!-- <div class="ui-g-10">
      表1上传数据
    </div> -->
    <div class="ui-g-2" >
      <p-button (onClick)="search()" style="float: right;" label="查询"></p-button>
      <p-button label="导入Excel"  (onClick)="importClickMethod()" style="float: right;margin-right: 10px;"></p-button>
    </div>
  </div>
  <div class="ui-g-12 ui-g-nopad">
    <p-tabView [activeIndex]="index" (onChange)="onTabChange($event)">
      <p-tabPanel header="目标表" leftIcon="pi pi-calendar">
        <p-table [columns]="colsd" [value]="datad" selectionMode="single" [loading]="loading" [paginator]="true" [rows]="12">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" [style.width]="col.width">
                {{col.header}}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
              <td *ngFor="let col of columns">
                {{rowData[col.field]}}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
      <p-tabPanel header="科目表" leftIcon="pi pi-calendar">
        <p-table [columns]="colss" [value]="datas" selectionMode="single" [loading]="loading" [paginator]="true" [rows]="12">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" [style.width]="col.width">
                {{col.header}}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
              <td *ngFor="let col of columns">
                {{rowData[col.field]}}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
      <p-tabPanel header="SBU表" leftIcon="pi pi-calendar">
        <p-table [columns]="colsq" [value]="dataq" selectionMode="single" [loading]="loading" [paginator]="true" [rows]="12">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" [style.width]="col.width">
                {{col.header}}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
              <td *ngFor="let col of columns">
                {{rowData[col.field]}}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
    </p-tabView>
  </div>
</div>

<div class="importcontainer" style="display: none;">
  <section>
    <div class="selc">
      <div>
        <label>年度:</label>
      <p-dropdown [options]="yearList" [(ngModel)]="selectedYear"></p-dropdown>
      </div>
      <div>
        <p-button (onClick)="search()" style="float: right;" label="查询"></p-button>
        <p-button label="导入Excel"  (onClick)="importClickMethod()" style="float: right;margin-right: 10px;"></p-button>
      </div>
    </div>
  </section>
  <section>
    <p-tabView [activeIndex]="index" (onChange)="onTabChange($event)">
      <p-tabPanel header="目标表" leftIcon="pi pi-calendar">
        <p-table [columns]="colsd" [value]="datad" selectionMode="single" [loading]="loading" [paginator]="true" [rows]="12">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" [style.width]="col.width">
                {{col.header}}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
              <td *ngFor="let col of columns">
                {{rowData[col.field]}}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
      <p-tabPanel header="科目表" leftIcon="pi pi-calendar">
        <p-table [columns]="colss" [value]="datas" selectionMode="single" [loading]="loading" [paginator]="true" [rows]="12">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" [style.width]="col.width">
                {{col.header}}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
              <td *ngFor="let col of columns">
                {{rowData[col.field]}}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
      <p-tabPanel header="SBU表" leftIcon="pi pi-calendar">
        <p-table [columns]="colsq" [value]="dataq" selectionMode="single" [loading]="loading" [paginator]="true" [rows]="12">
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns" [pSortableColumn]="col.field" [style.width]="col.width">
                {{col.header}}
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData let-columns="columns">
            <tr [pSelectableRow]="rowData">
              <td *ngFor="let col of columns">
                {{rowData[col.field]}}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
    </p-tabView>
  </section>
</div>
<app-import-data (onPassData)="onPassData($event)"></app-import-data>
